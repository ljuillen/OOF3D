# OOF version (unreleased)
OOF.Microstructure.Create_From_ImageFile(filenames=ThreeDImagePattern(directory='ms_data/5color/',pattern='slice(0|([1-9][0-9]*))\\.png',sort=NumericalOrder()), microstructure_name='5color', height=automatic, width=automatic, depth=automatic)
OOF.Image.AutoGroup(image='5color:5color', name_template='%c')
OOF.Skeleton.New(name='skeleton', microstructure='5color', x_elements=6, y_elements=6, z_elements=6, skeleton_geometry=TetraSkeleton(arrangement='moderate'))
#OOF.Windows.Graphics.New()
#OOF.Graphics_1.Layer.Hide(n=0)
#OOF.Graphics_1.Layer.Select(n=0)
#OOF.Graphics_1.Layer.New(category='Skeleton', what='5color:skeleton', how=SkeletonQualityDisplay(alpha=0.3,colormap=ThermalMap(),min=automatic,max=automatic,filter=NullFilter()))
#OOF.Graphics_1.Settings.Camera.View(view=View(cameraPosition=Coord(-22.0298,38.115,50.0979), focalPoint=Coord(10,10,10), up=Coord(0.153284,0.86249,-0.482302), angle=30, clipPlanes=[], invertClip=0, suppressClip=0, size_x=621, size_y=615))
OOF.Skeleton.Modify(skeleton='5color:skeleton', modifier=Refine(targets=CheckHomogeneity(threshold=0.9),criterion=Unconditionally(),alpha=0.3))
OOF.Skeleton.Modify(skeleton='5color:skeleton', modifier=SnapNodes(targets=SnapAll(),criterion=AverageEnergy(alpha=0.3)))
